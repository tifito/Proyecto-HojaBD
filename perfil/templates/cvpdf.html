<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            margin: 40px;
            color: #111827;
            font-size: 11px;
        }

        .header {
            width: 100%;
            margin-bottom: 30px;
        }

        .header-table {
            width: 100%;
            border-collapse: collapse;
        }

        .header-left {
            width: 75%;
            vertical-align: top;
            padding-top: 18px;
        }

        .header-right {
            width: 25%;
            text-align: right;
            vertical-align: top;
            padding-top: 18px;
        }

        .header h1 {
            font-size: 24px;
            margin: 0 0 4px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #111827;
        }

        .titulo-profesional {
            font-size: 13px;
            color: #1f4ed8;
            font-weight: bold;
            line-height: 1.2;
            margin: 0 0 2px 0;
        }

        .contacto {
            font-size: 10px;
            color: #555;
            margin: 0;
            line-height: 1.2;
        }

        .foto {
            width: 110px;
            border: 1px solid #d1d5db;
        }

        .item {
            margin-bottom: 8px;
        }

        .seccion h2 {
            font-size: 13px;
            color: #1f4ed8;
            border-bottom: 1px solid #1f4ed8;
            padding-bottom: 4px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .resumen {
            font-size: 11px;
            color: #374151;
            line-height: 1.4;
            text-align: justify;
            margin-bottom: 6px;
        }

        .seccion {
            margin-top: 18px;
            page-break-inside: avoid;
        }

        .item b {
            font-size: 11.5px;
            color: #111;
            display: block;
            margin-bottom: 2px;
        }

        .item .desc {
            font-size: 10.5px;
            color: #4b5563;
            line-height: 1.4;
            margin-top: 3px;
        }

        .item .sub {
            font-size: 10.5px;
            color: #374151;
            margin-left: 6px;
        }
    </style>
</head>

<body>

<!-- HEADER -->
{% if mostrar_perfil %}
<div class="header">
    <table class="header-table">
        <tr>
            <td class="header-left">
                <h1>{{ perfil.nombres }} {{ perfil.apellidos }}</h1>

                {% if perfil.titulodescripcion %}
                <div class="titulo-profesional">
                    {{ perfil.titulodescripcion }}
                </div>
                {% endif %}

                {% if perfil.email or perfil.direcciondomiciliaria or perfil.telefonofijo %}
                <div class="contacto">
                    {% if perfil.email %}{{ perfil.email }}{% endif %}
                    {% if perfil.direcciondomiciliaria %} / {{ perfil.direcciondomiciliaria }}{% endif %}
                    {% if perfil.telefonofijo %} / {{ perfil.telefonofijo }}{% endif %}
                </div>
                {% endif %}
            </td>

            <td class="header-right">
                {% if perfil.fotodeperfil %}
                    <img src="{{ perfil.fotodeperfil.url }}" class="foto">
                {% endif %}
            </td>
        </tr>
    </table>
</div>
{% endif %}

<!-- PERFIL PROFESIONAL -->
{% if mostrar_descripcion and perfil.descripcionperfil %}
<div class="seccion">
    <h2>Perfil profesional</h2>
    <div class="resumen">
        {{ perfil.descripcionperfil }}
    </div>
</div>
{% endif %}

<!-- FORMACIÓN ACADÉMICA -->
{% if mostrar_educacion and academico %}
<div class="seccion">
    <h2>Formación académica</h2>
    {% for a in academico %}
        <div class="item">
            <b>{{ a.nombrerecurso }}{% if a.fechafin %} · {{ a.fechafin }}{% endif %}</b>
            {% if a.descripcion %}
                <div class="desc">{{ a.descripcion }}</div>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- CURSOS -->
{% if mostrar_cursos and cursos %}
<div class="seccion">
    <h2>Cursos realizados</h2>
    {% for c in cursos %}
        <div class="item">
            <b>{{ c.nombrecurso }}{% if c.fechafin %} · {{ c.fechafin }}{% endif %}</b>
            {% if c.descripcioncurso %}
                <div class="desc">{{ c.descripcioncurso }}</div>
            {% endif %}
            <div class="sub">{{ c.entidadpatrocinadora }} / {{ c.totalhoras }} horas</div>
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- EXPERIENCIA -->
{% if mostrar_experiencia and experiencias %}
<div class="seccion">
    <h2>Experiencia laboral</h2>
    {% for e in experiencias %}
        <div class="item">
            <b>{{ e.cargodesempenado }}</b>
            <div class="sub">
                {{ e.nombrempresa }}{% if e.lugarempresa %}, {{ e.lugarempresa }}{% endif %}
                {% if e.fechafingestion %} · {{ e.fechafingestion }}{% endif %}
            </div>
            {% if e.descripcionfunciones %}
                <div class="desc">{{ e.descripcionfunciones }}</div>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- PRODUCTO LABORAL -->
{% if mostrar_productos and productos %}
<div class="seccion">
    <h2>Producto laboral</h2>
    {% for p in productos %}
        <div class="item">
            <b>{{ p.nombreproducto }}{% if p.fechaproducto %} · {{ p.fechaproducto }}{% endif %}</b>
            {% if p.descripcion %}
                <div class="desc">{{ p.descripcion }}</div>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- RECONOCIMIENTOS -->
{% if mostrar_reconocimientos and reconocimientos %}
<div class="seccion">
    <h2>Reconocimientos</h2>
    {% for r in reconocimientos %}
        <div class="item">
            <b>{{ r.tiporeconocimiento }}{% if r.fechareconocimiento %} · {{ r.fechareconocimiento }}{% endif %}</b>
            {% if r.descripcionreconocimiento %}
                <div class="desc">{{ r.descripcionreconocimiento }}</div>
            {% endif %}
            <div class="sub">{{ r.entidadpatrocinadora }}</div>
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- CERTIFICADOS (CURSOS + RECONOCIMIENTOS) -->
{% if mostrar_cursos or mostrar_reconocimientos %}

<div style="page-break-before: always; text-align:center; margin-top:180px;">
    <h2 style="font-size:28px; border-bottom:none; color:#1f4ed8; letter-spacing:3px;">
        CERTIFICADOS
    </h2>
</div>

{% if mostrar_cursos and cursos %}
    {% for c in cursos %}
        {% if c.imagendelacolumnadearriba %}
            <div style="page-break-before: always; text-align:center;">
                <img src="{{ c.imagendelacolumnadearriba.url }}" style="width:100%; max-width:500px;">
            </div>
        {% endif %}
    {% endfor %}
{% endif %}

{% for r in reconocimientos %}
    {% if r.reconocimientodelacolumnadearriba %}
        {% with r.reconocimientodelacolumnadearriba.url as url_img %}
            <div style="page-break-before: always; display: flex; justify-content: center; align-items: center; height: 80vh;">
                <img src="{{ url_img|safe }}" style="max-width:500px; max-height:100%;">
            </div>
        {% endwith %}
    {% endif %}
{% endfor %}

{% endif %}

</body>
</html>
